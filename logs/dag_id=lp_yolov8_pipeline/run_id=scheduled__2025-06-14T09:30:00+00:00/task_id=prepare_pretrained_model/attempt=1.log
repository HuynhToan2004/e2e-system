[2025-06-14T10:02:08.943+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-06-14T10:02:08.964+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: lp_yolov8_pipeline.prepare_pretrained_model scheduled__2025-06-14T09:30:00+00:00 [queued]>
[2025-06-14T10:02:08.973+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: lp_yolov8_pipeline.prepare_pretrained_model scheduled__2025-06-14T09:30:00+00:00 [queued]>
[2025-06-14T10:02:08.974+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2025-06-14T10:02:09.003+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): prepare_pretrained_model> on 2025-06-14 09:30:00+00:00
[2025-06-14T10:02:09.019+0000] {standard_task_runner.py:63} INFO - Started process 325 to run task
[2025-06-14T10:02:09.022+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'lp_yolov8_pipeline', 'prepare_pretrained_model', 'scheduled__2025-06-14T09:30:00+00:00', '--job-id', '67', '--raw', '--subdir', 'DAGS_FOLDER/main.py', '--cfg-path', '/tmp/tmpioabo2oy']
[2025-06-14T10:02:09.024+0000] {standard_task_runner.py:91} INFO - Job 67: Subtask prepare_pretrained_model
[2025-06-14T10:02:09.072+0000] {task_command.py:426} INFO - Running <TaskInstance: lp_yolov8_pipeline.prepare_pretrained_model scheduled__2025-06-14T09:30:00+00:00 [running]> on host 693466fafeae
[2025-06-14T10:02:09.271+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='lp_yolov8_pipeline' AIRFLOW_CTX_TASK_ID='prepare_pretrained_model' AIRFLOW_CTX_EXECUTION_DATE='2025-06-14T09:30:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-06-14T09:30:00+00:00'
[2025-06-14T10:02:09.277+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-06-14T10:02:12.827+0000] {logging_mixin.py:188} WARNING - 2025/06/14 10:02:12 WARNING mlflow.utils.git_utils: Failed to import Git (the Git executable is probably not on your PATH), so Git SHA is not available. Error: Failed to initialize: Bad git executable.
The git executable must be specified in one of the following ways:
    - be included in your $PATH
    - be set via $GIT_PYTHON_GIT_EXECUTABLE
    - explicitly set via git.refresh(<full-path-to-git-executable>)

All git commands will error until this is rectified.

This initial message can be silenced or aggravated in the future by setting the
$GIT_PYTHON_REFRESH environment variable. Use one of the following values:
    - quiet|q|silence|s|silent|none|n|0: for no message or exception
    - warn|w|warning|log|l|1: for a warning message (logging level CRITICAL, displayed by default)
    - error|e|exception|raise|r|2: for a raised exception

Example:
    export GIT_PYTHON_REFRESH=quiet
[2025-06-14T10:02:24.472+0000] {logging_mixin.py:188} WARNING -   0%|          | 0.00/6.25M [00:00<?, ?B/s]
[2025-06-14T10:02:25.262+0000] {logging_mixin.py:188} WARNING -   2%|2         | 128k/6.25M [00:00<00:32, 197kB/s]
[2025-06-14T10:02:25.519+0000] {logging_mixin.py:188} WARNING -   6%|6         | 384k/6.25M [00:00<00:12, 489kB/s]
[2025-06-14T10:02:26.808+0000] {logging_mixin.py:188} WARNING -   8%|8         | 512k/6.25M [00:02<00:28, 211kB/s]
[2025-06-14T10:02:29.896+0000] {logging_mixin.py:188} WARNING -  18%|#8        | 1.12M/6.25M [00:05<00:25, 212kB/s]
[2025-06-14T10:02:33.355+0000] {logging_mixin.py:188} WARNING -  32%|###2      | 2.00M/6.25M [00:08<00:18, 240kB/s]
[2025-06-14T10:02:42.807+0000] {logging_mixin.py:188} WARNING -  34%|###4      | 2.12M/6.25M [00:18<00:49, 87.4kB/s]
[2025-06-14T10:02:42.922+0000] {logging_mixin.py:188} WARNING -  48%|####8     | 3.00M/6.25M [00:18<00:19, 179kB/s] 
[2025-06-14T10:02:43.039+0000] {logging_mixin.py:188} WARNING -  54%|#####4    | 3.38M/6.25M [00:18<00:12, 232kB/s]
[2025-06-14T10:02:43.089+0000] {logging_mixin.py:188} WARNING - 100%|##########| 6.25M/6.25M [00:18<00:00, 354kB/s]
[2025-06-14T10:02:43.515+0000] {logging_mixin.py:188} INFO - Device: CPU
[2025-06-14T10:02:44.687+0000] {font_manager.py:1639} INFO - generated new fontManager
[2025-06-14T10:02:47.044+0000] {logging_mixin.py:188} WARNING -   0%|          | 0.00/755k [00:00<?, ?B/s]
[2025-06-14T10:02:47.175+0000] {logging_mixin.py:188} WARNING -  34%|###3      | 256k/755k [00:00<00:00, 2.04MB/s]
[2025-06-14T10:02:47.282+0000] {logging_mixin.py:188} WARNING -  68%|######7   | 512k/755k [00:00<00:00, 2.26MB/s]
[2025-06-14T10:02:47.338+0000] {logging_mixin.py:188} WARNING - 100%|##########| 755k/755k [00:00<00:00, 2.65MB/s]
[2025-06-14T10:02:47.712+0000] {logging_mixin.py:188} WARNING - train: Scanning /opt/***/app/src/dataset/train/labels...:   0%|          | 0/381 [00:00<?, ?it/s]
[2025-06-14T10:02:47.822+0000] {logging_mixin.py:188} WARNING - train: Scanning /opt/***/app/src/dataset/train/labels... 6 images, 0 backgrounds, 0 corrupt:   2%|1         | 6/381 [00:00<00:06, 55.44it/s]
[2025-06-14T10:02:47.923+0000] {logging_mixin.py:188} WARNING - train: Scanning /opt/***/app/src/dataset/train/labels... 17 images, 0 backgrounds, 0 corrupt:   4%|4         | 17/381 [00:00<00:04, 85.95it/s]
[2025-06-14T10:02:48.024+0000] {logging_mixin.py:188} WARNING - train: Scanning /opt/***/app/src/dataset/train/labels... 142 images, 0 backgrounds, 0 corrupt:  37%|###7      | 142/381 [00:00<00:00, 603.60it/s]
[2025-06-14T10:02:48.125+0000] {logging_mixin.py:188} WARNING - train: Scanning /opt/***/app/src/dataset/train/labels... 265 images, 0 backgrounds, 0 corrupt:  70%|######9   | 265/381 [00:00<00:00, 842.67it/s]
[2025-06-14T10:02:48.225+0000] {logging_mixin.py:188} WARNING - train: Scanning /opt/***/app/src/dataset/train/labels... 380 images, 0 backgrounds, 0 corrupt: 100%|#########9| 380/381 [00:00<00:00, 951.79it/s]
[2025-06-14T10:02:48.226+0000] {logging_mixin.py:188} WARNING - train: Scanning /opt/***/app/src/dataset/train/labels... 381 images, 0 backgrounds, 0 corrupt: 100%|##########| 381/381 [00:00<00:00, 742.46it/s]
[2025-06-14T10:02:48.244+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py:665 UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
[2025-06-14T10:02:48.250+0000] {logging_mixin.py:188} WARNING - val: Scanning /opt/***/app/src/dataset/valid/labels...:   0%|          | 0/109 [00:00<?, ?it/s]
[2025-06-14T10:02:48.346+0000] {logging_mixin.py:188} WARNING - val: Scanning /opt/***/app/src/dataset/valid/labels... 109 images, 0 backgrounds, 0 corrupt: 100%|##########| 109/109 [00:00<00:00, 1141.65it/s]
[2025-06-14T10:02:48.354+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.10/site-packages/torch/utils/data/dataloader.py:665 UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
[2025-06-14T10:02:51.156+0000] {logging_mixin.py:188} WARNING -   0%|          | 0/24 [00:00<?, ?it/s]
[2025-06-14T10:04:44.343+0000] {job.py:218} ERROR - Job heartbeat got an exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.10/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: could not translate host name "postgres" to address: Temporary failure in name resolution


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/jobs/job.py", line 213, in heartbeat
    heartbeat_callback(session)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/utils/session.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/jobs/local_task_job_runner.py", line 258, in heartbeat_callback
    self.task_instance.refresh_from_db()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/utils/session.py", line 79, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 1821, in refresh_from_db
    _refresh_from_db(task_instance=self, session=session, lock_for_update=lock_for_update)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 510, in _refresh_from_db
    ti = TaskInstance.get_task_instance(
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/api_internal/internal_api_call.py", line 115, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/utils/session.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 1807, in get_task_instance
    return query.one_or_none()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2850, in one_or_none
    return self._iter().one_or_none()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2916, in _iter
    result = self.session.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.10/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) could not translate host name "postgres" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-06-14T10:04:46.038+0000] {job.py:226} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
